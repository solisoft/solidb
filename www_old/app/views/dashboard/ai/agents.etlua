<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="md:flex md:items-center md:justify-between mb-8">
    <div class="flex-1 min-w-0">
      <h2 class="text-3xl font-bold leading-7 text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-teal-400 sm:text-4xl sm:truncate">
        AI Agents
      </h2>
      <p class="mt-2 text-sm text-gray-400">Manage registered AI workers and monitor their status.</p>
    </div>
    <div class="mt-4 flex md:mt-0 md:ml-4">
      <button type="button" onclick="openAgentModal()" class="ml-3 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
        New Agent
      </button>
    </div>
  </div>

  <ai-agents-table db="<%= Params['db'] %>"></ai-agents-table>
  <ai-agent-modal db="<%= Params['db'] %>"></ai-agent-modal>
</div>

<script type="module">
  import AiAgentsTable from '<%= PublicPath("/app/components/ai-agents-table.riot.js") %>'
  import AiAgentModal from '<%= PublicPath("/app/components/ai-agent-modal.riot.js") %>'
  
  riot.register('ai-agents-table', AiAgentsTable)
  riot.register('ai-agent-modal', AiAgentModal)
  
  const agentsTable = riot.mount('ai-agents-table', {
    db: "<%= Params['db'] %>"
  })[0]

  const agentModal = riot.mount('ai-agent-modal', {
    db: "<%= Params['db'] %>",
    show: false,
    onClose: () => {
        agentModal.update({ show: false })
    },
    onSuccess: () => {
        agentsTable.loadAgents()
    }
  })[0]

  window.openAgentModal = () => {
    agentModal.open()
  }
</script>
